# --------------------------------------REQUIREMENTS--------------------------------------
from flask import Flask, jsonify, request, abort, redirect, url_for, session, render_template
from flask_session import Session
from flask_dance.contrib.github import make_github_blueprint, github
import psycopg2
import sys
import os
import numpy as np
import pandas as pd
import credentials as creds
import pandas.io.sql as psql
import json
# --------------------------------------REQUIREMENTS--------------------------------------

"""
API important links explanation:
/refresh (GET)
-> Refreshes the session, removing the cookies and allowing you to start 
from the original create session again

/session/create (POST)
-> Generate session number, return the session number to user
-> Need key value for lat, long ,transport_mode, speed, quality
-> Generates lat, long, preferences and others and stores it in the database
-> Only for OAuth authenticated users

/session/<session_id> (PUT)
-> Insert details for each particular user
-> Need key value for lat, long ,transport_mode, speed, quality

/session/<session_id> (GET)
-> Get all session details
-> Requires OAuth

/session/<session_id>/calculate (GET)
-> If OAuth is provided, run the calculation
-> Redirect to results page

/session/<session_id>/results (GET)
-> Use this page for showing results to prevent lag
-> If OAuth is provided or IP address matches, show results

"""

app = Flask(__name__)

#The secret key is necessary for session to work
app.secret_key = 'super dsagbrjuyki64y5tg4fd key'


@app.route('/')
def index():
    #A placeholder to check if the website is working
    return 'Main Site Goes Here'

@app.route('/session/<session_id>/get_details')
def get_details(session_id):
    if request.method == "GET":
        return render_template('Geoloc2.html')

@app.route('/session/<session_id>/results_display')
def results_display(session_id):
    if request.method == "GET":
        return render_template('Geoloc.html') 

@app.route('/session/create', methods=['POST'])
def create_session():
    result = '{"session_id":"123456"}'
    return result
#Create a function to refresh the data if necessary
@app.route('/refresh', methods=['GET'])
def refresh():
    #Remove the cookies
    session.clear()
    return "No refresh necessary for api pregen v2"

@app.route('/session/<session_id>', methods=['POST', 'GET'])
def manage_details(session_id):
    if request.method == 'POST':
        results = '{  "updated_info_for_session_id": "123456"}'
        return results

    elif request.method == 'GET':
        results = """
                { 
        "users":[ 
            { 
                "lat":1.3672154,
                "long":103.8674763,
                "metrics":{ 
                    "quality":5,
                    "speed":5
                },
                "transport_mode":"public",
                "username":"Philip"
            },
            { 
                "identifier":"Stephen",
                "lat":1.2848664,
                "long":103.8244263,
                "metrics":{ 
                    "quality":5,
                    "speed":5
                },
                "transport_mode":"public"
            },
            { 
                "identifier":"Julia",
                "lat":1.333489,
                "long":103.865812,
                "metrics":{ 
                    "quality":5,
                    "speed":5
                },
                "transport_mode":"public"
            }
        ]
        }
        """
        return results


@app.route('/session/<session_id>/calculate', methods=['GET'])
def calculate(session_id):
    #Always return the result, for testing purposes
    return redirect("/session/"+session_id+"/results", code=302)


#The results come from here
@app.route('/session/<session_id>/results', methods=['GET'])
def results(session_id):

    # Make the fake results json
    results="""
    {
  "Blk 163 Karaoke Club": {
    "1863993257": {
      "end_vid": "1745092585",
      "latitude": [
        1.4547757,
        1.4547904,
        1.4547952,
        1.4547952,
        1.4548299,
        1.4548299,
        1.4548466,
        1.4547533,
        1.4547533,
        1.4547408,
        1.4547408,
        1.4547106,
        1.4546449,
        1.4545705,
        1.4544928,
        1.4544928,
        1.4540946,
        1.4540946,
        1.4538797,
        1.4536621,
        1.4530313,
        1.4516748,
        1.4493715,
        1.4479304,
        1.4462506,
        1.4441847,
        1.4441847,
        1.4420027,
        1.4399222,
        1.4383726,
        1.4326551,
        1.4321727,
        1.4321628,
        1.431759,
        1.3760736,
        1.3796621,
        1.3807079,
        1.3800853,
        1.3780126,
        1.3767004,
        1.3736392,
        1.3701469,
        1.3676502,
        1.3639676,
        1.3615911,
        1.3594346,
        1.3579075,
        1.3521782,
        1.3490461,
        1.3490461,
        1.3489846
      ],
      "longtitude": [
        103.8116203,
        103.8118202,
        103.8120528,
        103.8120528,
        103.8124628,
        103.8124628,
        103.8126161,
        103.8126334,
        103.8126334,
        103.812478,
        103.812478,
        103.8120073,
        103.8113957,
        103.8110141,
        103.8107204,
        103.8107204,
        103.8105739,
        103.8105739,
        103.8106789,
        103.8108027,
        103.8077359,
        103.8054076,
        103.8010946,
        103.7980968,
        103.7932326,
        103.7892357,
        103.7892357,
        103.7859523,
        103.7873008,
        103.786431,
        103.7801832,
        103.7775663,
        103.7737502,
        103.7709144,
        103.7738529,
        103.7680841,
        103.7663931,
        103.7623772,
        103.7576168,
        103.7546065,
        103.7524312,
        103.7497477,
        103.747036,
        103.7432831,
        103.7440097,
        103.746855,
        103.747345,
        103.7461395,
        103.7446375,
        103.7446375,
        103.743346
      ],
      "restaurant_x": 103.7424558,
      "restaurant_y": 1.3481664,
      "start_user": "1863993257",
      "start_user_name": "identifier",
      "total_cost": "1.126614563765"
    },
    "246182171": {
      "end_vid": "1745092585",
      "latitude": [
        1.3255995,
        1.3255995,
        1.3256348,
        1.3256707,
        1.3256722,
        1.3257065,
        1.3259942,
        1.3268212,
        1.3278653,
        1.3278212,
        1.327056,
        1.3252642,
        1.3246044,
        1.324596,
        1.3246001,
        1.3245977,
        1.3245848,
        1.3257923,
        1.3300068,
        1.3336256,
        1.3348932,
        1.3356593,
        1.3375303,
        1.3399055,
        1.3421276,
        1.3424163,
        1.344776,
        1.3449679,
        1.3449679,
        1.3443977,
        1.3435914,
        1.3420521,
        1.3422222,
        1.3445689,
        1.3482296,
        1.3482296,
        1.3498103,
        1.3490435,
        1.3490461,
        1.3490461,
        1.3489846
      ],
      "longtitude": [
        103.6698346,
        103.6698346,
        103.6703054,
        103.6707836,
        103.6708038,
        103.671261,
        103.675095,
        103.6767058,
        103.6781813,
        103.6833268,
        103.6841078,
        103.6841046,
        103.6854243,
        103.6879536,
        103.6901998,
        103.6925798,
        103.6951473,
        103.6964727,
        103.6964375,
        103.696449,
        103.6980268,
        103.7057869,
        103.7047128,
        103.7045874,
        103.7137671,
        103.71454,
        103.7209062,
        103.7247097,
        103.7247097,
        103.7276508,
        103.7315508,
        103.7336432,
        103.7356447,
        103.7365119,
        103.7382493,
        103.7382493,
        103.7410657,
        103.7445347,
        103.7446375,
        103.7446375,
        103.743346
      ],
      "restaurant_x": 103.7424558,
      "restaurant_y": 1.3481664,
      "start_user": "246182171",
      "start_user_name": "username",
      "total_cost": "1.126614563765"
    },
    "6026248118": {
      "end_vid": "1745092585",
      "latitude": [
        1.3367202,
        1.3366179,
        1.3369956,
        1.3369956,
        1.3366354,
        1.3363568,
        1.3363568,
        1.3363084,
        1.3363084,
        1.3354019,
        1.3338024,
        1.3334036,
        1.3314517,
        1.3290448,
        1.3267442,
        1.3267442,
        1.3254173,
        1.3250166,
        1.3243218,
        1.3214273,
        1.3152116,
        1.3126789,
        1.2998451,
        1.2998451,
        1.302073,
        1.3041166,
        1.3061847,
        1.340167,
        1.3405215,
        1.3405215,
        1.342922,
        1.342922,
        1.3438612,
        1.3438612,
        1.3463305,
        1.3470288,
        1.3491599,
        1.3521018,
        1.3521782,
        1.3490461,
        1.3490461,
        1.3489846
      ],
      "longtitude": [
        103.9541399,
        103.9541856,
        103.9550784,
        103.9550784,
        103.9552224,
        103.9553392,
        103.9553392,
        103.9553589,
        103.9553589,
        103.9533073,
        103.9496164,
        103.9487631,
        103.9475278,
        103.9493644,
        103.9458241,
        103.9458241,
        103.9415496,
        103.9392002,
        103.9338205,
        103.9323899,
        103.9334951,
        103.9340718,
        103.8566322,
        103.8566322,
        103.8544724,
        103.8518779,
        103.8490716,
        103.7744157,
        103.7723185,
        103.7723185,
        103.7700945,
        103.7700945,
        103.7693057,
        103.7693057,
        103.7588968,
        103.7565422,
        103.7532888,
        103.7494547,
        103.7461395,
        103.7446375,
        103.7446375,
        103.743346
      ],
      "restaurant_x": 103.7424558,
      "restaurant_y": 1.3481664,
      "start_user": "6026248118",
      "start_user_name": "identifier",
      "total_cost": "1.126614563765"
    }
  },
  "Bukit Batok Hillside Park": {
    "1863993257": {
      "end_vid": "1369046888",
      "latitude": [
        1.4547757,
        1.4547904,
        1.4547952,
        1.4547952,
        1.4548299,
        1.4548299,
        1.4548466,
        1.4547533,
        1.4547533,
        1.4547408,
        1.4547408,
        1.4547106,
        1.4546449,
        1.4545705,
        1.4544928,
        1.4544928,
        1.4540946,
        1.4540946,
        1.4538797,
        1.4536621,
        1.4530313,
        1.4516748,
        1.4493715,
        1.4479304,
        1.4462506,
        1.4441847,
        1.4441847,
        1.4420027,
        1.4399222,
        1.4383726,
        1.4326551,
        1.4321727,
        1.4321628,
        1.431759,
        1.3760736,
        1.3796621,
        1.3807079,
        1.3800853,
        1.3780126,
        1.3767004,
        1.3736392,
        1.3701469,
        1.3676502,
        1.3639676,
        1.3615911,
        1.3594346,
        1.3579075,
        1.3558779,
        1.3599065
      ],
      "longtitude": [
        103.8116203,
        103.8118202,
        103.8120528,
        103.8120528,
        103.8124628,
        103.8124628,
        103.8126161,
        103.8126334,
        103.8126334,
        103.812478,
        103.812478,
        103.8120073,
        103.8113957,
        103.8110141,
        103.8107204,
        103.8107204,
        103.8105739,
        103.8105739,
        103.8106789,
        103.8108027,
        103.8077359,
        103.8054076,
        103.8010946,
        103.7980968,
        103.7932326,
        103.7892357,
        103.7892357,
        103.7859523,
        103.7873008,
        103.786431,
        103.7801832,
        103.7775663,
        103.7737502,
        103.7709144,
        103.7738529,
        103.7680841,
        103.7663931,
        103.7623772,
        103.7576168,
        103.7546065,
        103.7524312,
        103.7497477,
        103.747036,
        103.7432831,
        103.7440097,
        103.746855,
        103.747345,
        103.7473866,
        103.7462327
      ],
      "restaurant_x": 103.7459475,
      "restaurant_y": 1.3587313,
      "start_user": "1863993257",
      "start_user_name": "identifier",
      "total_cost": "1.128619694905"
    },
    "246182171": {
      "end_vid": "1369046888",
      "latitude": [
        1.3255995,
        1.3255995,
        1.3256348,
        1.3256707,
        1.3256722,
        1.3257065,
        1.3259942,
        1.3268212,
        1.3278653,
        1.3278212,
        1.327056,
        1.3252642,
        1.3246044,
        1.324596,
        1.3246001,
        1.3245977,
        1.3245848,
        1.3257923,
        1.3300068,
        1.3336256,
        1.3348932,
        1.3356593,
        1.3375303,
        1.3399055,
        1.3421276,
        1.3424163,
        1.344776,
        1.3449679,
        1.3449679,
        1.3443977,
        1.3435914,
        1.3420521,
        1.3422222,
        1.3445689,
        1.3482296,
        1.3482296,
        1.3498103,
        1.3514867,
        1.3524091,
        1.3558779,
        1.3599065
      ],
      "longtitude": [
        103.6698346,
        103.6698346,
        103.6703054,
        103.6707836,
        103.6708038,
        103.671261,
        103.675095,
        103.6767058,
        103.6781813,
        103.6833268,
        103.6841078,
        103.6841046,
        103.6854243,
        103.6879536,
        103.6901998,
        103.6925798,
        103.6951473,
        103.6964727,
        103.6964375,
        103.696449,
        103.6980268,
        103.7057869,
        103.7047128,
        103.7045874,
        103.7137671,
        103.71454,
        103.7209062,
        103.7247097,
        103.7247097,
        103.7276508,
        103.7315508,
        103.7336432,
        103.7356447,
        103.7365119,
        103.7382493,
        103.7382493,
        103.7410657,
        103.7435109,
        103.7474397,
        103.7473866,
        103.7462327
      ],
      "restaurant_x": 103.7459475,
      "restaurant_y": 1.3587313,
      "start_user": "246182171",
      "start_user_name": "username",
      "total_cost": "1.128619694905"
    },
    "6026248118": {
      "end_vid": "1369046888",
      "latitude": [
        1.3367202,
        1.3366179,
        1.3369956,
        1.3369956,
        1.3366354,
        1.3363568,
        1.3363568,
        1.3363084,
        1.3363084,
        1.3354019,
        1.3338024,
        1.3334036,
        1.3314517,
        1.3290448,
        1.3267442,
        1.3267442,
        1.3254173,
        1.3250166,
        1.3243218,
        1.3214273,
        1.3152116,
        1.3126789,
        1.2998451,
        1.2998451,
        1.302073,
        1.3041166,
        1.3061847,
        1.340167,
        1.3405215,
        1.3405215,
        1.342922,
        1.342922,
        1.3438612,
        1.3438612,
        1.3463305,
        1.3470288,
        1.3491599,
        1.3521018,
        1.3558779,
        1.3599065
      ],
      "longtitude": [
        103.9541399,
        103.9541856,
        103.9550784,
        103.9550784,
        103.9552224,
        103.9553392,
        103.9553392,
        103.9553589,
        103.9553589,
        103.9533073,
        103.9496164,
        103.9487631,
        103.9475278,
        103.9493644,
        103.9458241,
        103.9458241,
        103.9415496,
        103.9392002,
        103.9338205,
        103.9323899,
        103.9334951,
        103.9340718,
        103.8566322,
        103.8566322,
        103.8544724,
        103.8518779,
        103.8490716,
        103.7744157,
        103.7723185,
        103.7723185,
        103.7700945,
        103.7700945,
        103.7693057,
        103.7693057,
        103.7588968,
        103.7565422,
        103.7532888,
        103.7494547,
        103.7473866,
        103.7462327
      ],
      "restaurant_x": 103.7459475,
      "restaurant_y": 1.3587313,
      "start_user": "6026248118",
      "start_user_name": "identifier",
      "total_cost": "1.128619694905"
    }
  },
  "Cashew Herbal Garden": {
    "1863993257": {
      "end_vid": "4605941435",
      "latitude": [
        1.4547757,
        1.4547904,
        1.4547952,
        1.4547952,
        1.4548299,
        1.4548299,
        1.4548466,
        1.4547533,
        1.4547533,
        1.4547408,
        1.4547408,
        1.4547106,
        1.4546449,
        1.4545705,
        1.4544928,
        1.4544928,
        1.4540946,
        1.4540946,
        1.4538797,
        1.4536621,
        1.4530313,
        1.4516748,
        1.4493715,
        1.4479304,
        1.4462506,
        1.4441847,
        1.4441847,
        1.4420027,
        1.4399222,
        1.4383726,
        1.4326551,
        1.4321727,
        1.4321628,
        1.431759,
        1.3760736,
        1.3764418,
        1.3760475
      ],
      "longtitude": [
        103.8116203,
        103.8118202,
        103.8120528,
        103.8120528,
        103.8124628,
        103.8124628,
        103.8126161,
        103.8126334,
        103.8126334,
        103.812478,
        103.812478,
        103.8120073,
        103.8113957,
        103.8110141,
        103.8107204,
        103.8107204,
        103.8105739,
        103.8105739,
        103.8106789,
        103.8108027,
        103.8077359,
        103.8054076,
        103.8010946,
        103.7980968,
        103.7932326,
        103.7892357,
        103.7892357,
        103.7859523,
        103.7873008,
        103.786431,
        103.7801832,
        103.7775663,
        103.7737502,
        103.7709144,
        103.7738529,
        103.7713565,
        103.7690664
      ],
      "restaurant_x": 103.7690717,
      "restaurant_y": 1.3746055,
      "start_user": "1863993257",
      "start_user_name": "identifier",
      "total_cost": "1.112421130919"
    },
    "246182171": {
      "end_vid": "4605941435",
      "latitude": [
        1.3255995,
        1.3255995,
        1.3256348,
        1.3256707,
        1.3256722,
        1.3257065,
        1.3259942,
        1.3268212,
        1.3278653,
        1.3278212,
        1.327056,
        1.3252642,
        1.3246044,
        1.324596,
        1.3246001,
        1.3245977,
        1.3245848,
        1.3257923,
        1.3300068,
        1.3336256,
        1.3348932,
        1.3356593,
        1.3375303,
        1.3399055,
        1.3421276,
        1.3424163,
        1.344776,
        1.3449679,
        1.3449679,
        1.3443977,
        1.3435914,
        1.3420521,
        1.3422222,
        1.3445689,
        1.3482296,
        1.3482296,
        1.3545696,
        1.3571354,
        1.3588769,
        1.3619565,
        1.3655195,
        1.368429,
        1.3706363,
        1.3755644,
        1.3771625,
        1.3783648,
        1.3804991,
        1.3804423,
        1.3779179,
        1.3764418,
        1.3760475
      ],
      "longtitude": [
        103.6698346,
        103.6698346,
        103.6703054,
        103.6707836,
        103.6708038,
        103.671261,
        103.675095,
        103.6767058,
        103.6781813,
        103.6833268,
        103.6841078,
        103.6841046,
        103.6854243,
        103.6879536,
        103.6901998,
        103.6925798,
        103.6951473,
        103.6964727,
        103.6964375,
        103.696449,
        103.6980268,
        103.7057869,
        103.7047128,
        103.7045874,
        103.7137671,
        103.71454,
        103.7209062,
        103.7247097,
        103.7247097,
        103.7276508,
        103.7315508,
        103.7336432,
        103.7356447,
        103.7365119,
        103.7382493,
        103.7382493,
        103.7365251,
        103.7373028,
        103.7388114,
        103.7415066,
        103.7444334,
        103.7477655,
        103.7500642,
        103.7531826,
        103.7557652,
        103.7579801,
        103.7629025,
        103.7670949,
        103.7711677,
        103.7713565,
        103.7690664
      ],
      "restaurant_x": 103.7690717,
      "restaurant_y": 1.3746055,
      "start_user": "246182171",
      "start_user_name": "username",
      "total_cost": "1.112421130919"
    },
    "6026248118": {
      "end_vid": "4605941435",
      "latitude": [
        1.3367202,
        1.3366179,
        1.3369956,
        1.3369956,
        1.3366354,
        1.3363568,
        1.3363568,
        1.3363084,
        1.3363084,
        1.3354019,
        1.3338024,
        1.3334036,
        1.3314517,
        1.3290448,
        1.3267442,
        1.3267442,
        1.3254173,
        1.3250166,
        1.3243218,
        1.3214273,
        1.3152116,
        1.3126789,
        1.2998451,
        1.2998451,
        1.302073,
        1.3041166,
        1.3061847,
        1.3090112,
        1.3111906,
        1.3119407,
        1.3142538,
        1.3142538,
        1.316783,
        1.318538,
        1.3192524,
        1.3202816,
        1.3202816,
        1.3232381,
        1.3760736,
        1.3764418,
        1.3760475
      ],
      "longtitude": [
        103.9541399,
        103.9541856,
        103.9550784,
        103.9550784,
        103.9552224,
        103.9553392,
        103.9553392,
        103.9553589,
        103.9553589,
        103.9533073,
        103.9496164,
        103.9487631,
        103.9475278,
        103.9493644,
        103.9458241,
        103.9458241,
        103.9415496,
        103.9392002,
        103.9338205,
        103.9323899,
        103.9334951,
        103.9340718,
        103.8566322,
        103.8566322,
        103.8544724,
        103.8518779,
        103.8490716,
        103.8463127,
        103.8425922,
        103.8407372,
        103.8377425,
        103.8377425,
        103.835624,
        103.8314273,
        103.8292015,
        103.8257777,
        103.8257777,
        103.8263039,
        103.7738529,
        103.7713565,
        103.7690664
      ],
      "restaurant_x": 103.7690717,
      "restaurant_y": 1.3746055,
      "start_user": "6026248118",
      "start_user_name": "identifier",
      "total_cost": "1.112421130919"
    }
  },
  "GNC Live Well - Hillion Mall": {
    "1863993257": {
      "end_vid": "4592745095",
      "latitude": [
        1.4547757,
        1.4547904,
        1.4547952,
        1.4547952,
        1.4548299,
        1.4548299,
        1.4548466,
        1.4547533,
        1.4547533,
        1.4547408,
        1.4547408,
        1.4547106,
        1.4546449,
        1.4545705,
        1.4544928,
        1.4544928,
        1.4540946,
        1.4540946,
        1.4538797,
        1.4536621,
        1.4530313,
        1.4516748,
        1.4493715,
        1.4479304,
        1.4462506,
        1.4441847,
        1.4441847,
        1.4420027,
        1.4399222,
        1.4383726,
        1.4326551,
        1.4321727,
        1.4321628,
        1.431759,
        1.3760736,
        1.3796621,
        1.3807079,
        1.3796949,
        1.3778789
      ],
      "longtitude": [
        103.8116203,
        103.8118202,
        103.8120528,
        103.8120528,
        103.8124628,
        103.8124628,
        103.8126161,
        103.8126334,
        103.8126334,
        103.812478,
        103.812478,
        103.8120073,
        103.8113957,
        103.8110141,
        103.8107204,
        103.8107204,
        103.8105739,
        103.8105739,
        103.8106789,
        103.8108027,
        103.8077359,
        103.8054076,
        103.8010946,
        103.7980968,
        103.7932326,
        103.7892357,
        103.7892357,
        103.7859523,
        103.7873008,
        103.786431,
        103.7801832,
        103.7775663,
        103.7737502,
        103.7709144,
        103.7738529,
        103.7680841,
        103.7663931,
        103.7640804,
        103.763553
      ],
      "restaurant_x": 103.7630439,
      "restaurant_y": 1.3779581,
      "start_user": "1863993257",
      "start_user_name": "identifier",
      "total_cost": "1.114986530336"
    },
    "246182171": {
      "end_vid": "4592745095",
      "latitude": [
        1.3255995,
        1.3255995,
        1.3256348,
        1.3256707,
        1.3256722,
        1.3257065,
        1.3259942,
        1.3268212,
        1.3278653,
        1.3278212,
        1.327056,
        1.3252642,
        1.3246044,
        1.324596,
        1.3246001,
        1.3245977,
        1.3245848,
        1.3257923,
        1.3300068,
        1.3336256,
        1.3348932,
        1.3356593,
        1.3375303,
        1.3399055,
        1.3421276,
        1.3424163,
        1.344776,
        1.3449679,
        1.3449679,
        1.3443977,
        1.3435914,
        1.3420521,
        1.3422222,
        1.3445689,
        1.3482296,
        1.3482296,
        1.3545696,
        1.3571354,
        1.3588769,
        1.3619565,
        1.3655195,
        1.368429,
        1.3706363,
        1.3755644,
        1.3771625,
        1.3783648,
        1.3780452,
        1.3778789
      ],
      "longtitude": [
        103.6698346,
        103.6698346,
        103.6703054,
        103.6707836,
        103.6708038,
        103.671261,
        103.675095,
        103.6767058,
        103.6781813,
        103.6833268,
        103.6841078,
        103.6841046,
        103.6854243,
        103.6879536,
        103.6901998,
        103.6925798,
        103.6951473,
        103.6964727,
        103.6964375,
        103.696449,
        103.6980268,
        103.7057869,
        103.7047128,
        103.7045874,
        103.7137671,
        103.71454,
        103.7209062,
        103.7247097,
        103.7247097,
        103.7276508,
        103.7315508,
        103.7336432,
        103.7356447,
        103.7365119,
        103.7382493,
        103.7382493,
        103.7365251,
        103.7373028,
        103.7388114,
        103.7415066,
        103.7444334,
        103.7477655,
        103.7500642,
        103.7531826,
        103.7557652,
        103.7579801,
        103.7622265,
        103.763553
      ],
      "restaurant_x": 103.7630439,
      "restaurant_y": 1.3779581,
      "start_user": "246182171",
      "start_user_name": "username",
      "total_cost": "1.114986530336"
    },
    "6026248118": {
      "end_vid": "4592745095",
      "latitude": [
        1.3367202,
        1.3366179,
        1.3369956,
        1.3369956,
        1.3366354,
        1.3363568,
        1.3363568,
        1.3363084,
        1.3363084,
        1.3354019,
        1.3338024,
        1.3334036,
        1.3314517,
        1.3290448,
        1.3267442,
        1.3267442,
        1.3254173,
        1.3270437,
        1.3300512,
        1.3317104,
        1.3316266,
        1.330932,
        1.3302289,
        1.3297493,
        1.3292184,
        1.3369129,
        1.3373183,
        1.3356815,
        1.3352263,
        1.3346494,
        1.3326138,
        1.3301132,
        1.3281067,
        1.329403,
        1.325726,
        1.3665431,
        1.3688487,
        1.3716532,
        1.3736576,
        1.3767779,
        1.3796621,
        1.3807079,
        1.3796949,
        1.3778789
      ],
      "longtitude": [
        103.9541399,
        103.9541856,
        103.9550784,
        103.9550784,
        103.9552224,
        103.9553392,
        103.9553392,
        103.9553589,
        103.9553589,
        103.9533073,
        103.9496164,
        103.9487631,
        103.9475278,
        103.9493644,
        103.9458241,
        103.9458241,
        103.9415496,
        103.9401376,
        103.9395734,
        103.9381657,
        103.9349956,
        103.9319887,
        103.9291637,
        103.9272657,
        103.9245759,
        103.9180845,
        103.9146039,
        103.9111457,
        103.9095774,
        103.9068189,
        103.9030735,
        103.9042177,
        103.9057207,
        103.8434338,
        103.8339051,
        103.7754232,
        103.7753252,
        103.7746064,
        103.7728295,
        103.7714092,
        103.7680841,
        103.7663931,
        103.7640804,
        103.763553
      ],
      "restaurant_x": 103.7630439,
      "restaurant_y": 1.3779581,
      "start_user": "6026248118",
      "start_user_name": "identifier",
      "total_cost": "1.114986530336"
    }
  },
  "possible_locations": [
    "Bukit Batok Hillside Park",
    "Blk 163 Karaoke Club",
    "GNC Live Well - Hillion Mall",
    "Cashew Herbal Garden",
    "旺 WANG 海鲜"
  ],
  "users": {
    "1863993257": {
      "latitude": "1.454612",
      "longtitude": "103.811677"
    },
    "246182171": {
      "latitude": 1.325646,
      "longtitude": 103.670067
    },
    "6026248118": {
      "latitude": "1.336737",
      "longtitude": "103.954140"
    }
  },
  "旺 WANG 海鲜": {
    "1863993257": {
      "end_vid": "5988713446",
      "latitude": [
        1.4547757,
        1.4547904,
        1.4547952,
        1.4547952,
        1.4548299,
        1.4548299,
        1.4548466,
        1.4547533,
        1.4547533,
        1.4547408,
        1.4547408,
        1.4547106,
        1.4546449,
        1.4545705,
        1.4544928,
        1.4544928,
        1.4540946,
        1.4540946,
        1.4538797,
        1.4536621,
        1.4530313,
        1.4516748,
        1.4493715,
        1.4479304,
        1.4462506,
        1.4441847,
        1.4441847,
        1.4420027,
        1.4399222,
        1.4383726,
        1.4326551,
        1.4321727,
        1.4321628,
        1.431759,
        1.3760736,
        1.3764418,
        1.373507,
        1.373244,
        1.3767779
      ],
      "longtitude": [
        103.8116203,
        103.8118202,
        103.8120528,
        103.8120528,
        103.8124628,
        103.8124628,
        103.8126161,
        103.8126334,
        103.8126334,
        103.812478,
        103.812478,
        103.8120073,
        103.8113957,
        103.8110141,
        103.8107204,
        103.8107204,
        103.8105739,
        103.8105739,
        103.8106789,
        103.8108027,
        103.8077359,
        103.8054076,
        103.8010946,
        103.7980968,
        103.7932326,
        103.7892357,
        103.7892357,
        103.7859523,
        103.7873008,
        103.786431,
        103.7801832,
        103.7775663,
        103.7737502,
        103.7709144,
        103.7738529,
        103.7713565,
        103.7708734,
        103.7701634,
        103.7714092
      ],
      "restaurant_x": 103.7705011,
      "restaurant_y": 1.3765064,
      "start_user": "1863993257",
      "start_user_name": "identifier",
      "total_cost": "1.1223131026"
    },
    "246182171": {
      "end_vid": "5988713446",
      "latitude": [
        1.3255995,
        1.3255995,
        1.3256348,
        1.3256707,
        1.3256722,
        1.3257065,
        1.3259942,
        1.3268212,
        1.3278653,
        1.3278212,
        1.327056,
        1.3252642,
        1.3246044,
        1.324596,
        1.3246001,
        1.3245977,
        1.3245848,
        1.3257923,
        1.3300068,
        1.3336256,
        1.3348932,
        1.3356593,
        1.3375303,
        1.3399055,
        1.3421276,
        1.3424163,
        1.344776,
        1.3449679,
        1.3449679,
        1.3443977,
        1.3435914,
        1.3420521,
        1.3422222,
        1.3445689,
        1.3482296,
        1.3482296,
        1.3545696,
        1.3571354,
        1.3588769,
        1.3619565,
        1.3655195,
        1.368429,
        1.3706363,
        1.3755644,
        1.3771625,
        1.3783648,
        1.3804991,
        1.3786109,
        1.3770566,
        1.375719,
        1.3767779
      ],
      "longtitude": [
        103.6698346,
        103.6698346,
        103.6703054,
        103.6707836,
        103.6708038,
        103.671261,
        103.675095,
        103.6767058,
        103.6781813,
        103.6833268,
        103.6841078,
        103.6841046,
        103.6854243,
        103.6879536,
        103.6901998,
        103.6925798,
        103.6951473,
        103.6964727,
        103.6964375,
        103.696449,
        103.6980268,
        103.7057869,
        103.7047128,
        103.7045874,
        103.7137671,
        103.71454,
        103.7209062,
        103.7247097,
        103.7247097,
        103.7276508,
        103.7315508,
        103.7336432,
        103.7356447,
        103.7365119,
        103.7382493,
        103.7382493,
        103.7365251,
        103.7373028,
        103.7388114,
        103.7415066,
        103.7444334,
        103.7477655,
        103.7500642,
        103.7531826,
        103.7557652,
        103.7579801,
        103.7629025,
        103.764583,
        103.7675992,
        103.7697536,
        103.7714092
      ],
      "restaurant_x": 103.7705011,
      "restaurant_y": 1.3765064,
      "start_user": "246182171",
      "start_user_name": "username",
      "total_cost": "1.1223131026"
    },
    "6026248118": {
      "end_vid": "5988713446",
      "latitude": [
        1.3367202,
        1.3366179,
        1.3369956,
        1.3369956,
        1.3366354,
        1.3363568,
        1.3363568,
        1.3363084,
        1.3363084,
        1.3354019,
        1.3338024,
        1.3334036,
        1.3314517,
        1.3290448,
        1.3267442,
        1.3267442,
        1.3254173,
        1.3270437,
        1.3300512,
        1.3317104,
        1.3316266,
        1.330932,
        1.3302289,
        1.3297493,
        1.3292184,
        1.3369129,
        1.3373183,
        1.3356815,
        1.3352263,
        1.3346494,
        1.3326138,
        1.3301132,
        1.3281067,
        1.329403,
        1.325726,
        1.3665431,
        1.3688487,
        1.3716532,
        1.3736576,
        1.3767779
      ],
      "longtitude": [
        103.9541399,
        103.9541856,
        103.9550784,
        103.9550784,
        103.9552224,
        103.9553392,
        103.9553392,
        103.9553589,
        103.9553589,
        103.9533073,
        103.9496164,
        103.9487631,
        103.9475278,
        103.9493644,
        103.9458241,
        103.9458241,
        103.9415496,
        103.9401376,
        103.9395734,
        103.9381657,
        103.9349956,
        103.9319887,
        103.9291637,
        103.9272657,
        103.9245759,
        103.9180845,
        103.9146039,
        103.9111457,
        103.9095774,
        103.9068189,
        103.9030735,
        103.9042177,
        103.9057207,
        103.8434338,
        103.8339051,
        103.7754232,
        103.7753252,
        103.7746064,
        103.7728295,
        103.7714092
      ],
      "restaurant_x": 103.7705011,
      "restaurant_y": 1.3765064,
      "start_user": "6026248118",
      "start_user_name": "identifier",
      "total_cost": "1.1223131026"
    }
  }
}
    """
    

    # return the results
    return results


if __name__ == '__main__':

    # Run the App
    app.run(host='0.0.0.0', debug=True, use_reloader=False, port=5000)

    #These settings are required for session to work
    app.config['SESSION_TYPE'] = 'filesystem'
    app.config['PERMANANT_SESSION_LIFETIME'] = True
    app.config.from_object(__name__)
    Session(app)
